package com.test;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
import com.test.entity.User;
import com.test.entity.VO.es.EsBase;
import com.test.entity.VO.es.EsData;
import com.test.mapper.UserMapper;
import com.test.service.UserService;
import lombok.extern.slf4j.Slf4j;
import org.apache.commons.lang3.StringUtils;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.util.CollectionUtils;

import java.time.LocalDateTime;
import java.util.*;
import java.util.concurrent.*;
import java.util.concurrent.atomic.AtomicReference;


@RunWith(SpringRunner.class)
@SpringBootTest
@Slf4j
public class TestPro {

    @Autowired
    private UserService userService;
    @Autowired
    private UserMapper userMapper;

    @Test
    public void test1() throws InterruptedException {
        //todo 多线程
        ExecutorService threadPool = Executors.newFixedThreadPool(100);
        CountDownLatch countDownLatch = new CountDownLatch(100); //数量时任务的总量
        for (int i = 0; i <100 ; i++) {
            final int finalint = 1;
            threadPool.execute(() ->{
                    try {
                        User user = new User(null, "zw" + finalint, finalint, "男", "重庆",new Date());
                        System.out.println(Thread.currentThread().getName()+" 开始执行");
                        long startTime = System.currentTimeMillis();
                        long endTime = System.currentTimeMillis();
                        System.out.println("请求时间： "+(endTime - startTime));
                        Thread.sleep(100*finalint);
                        userService.save(user);
                        System.out.println(Thread.currentThread().getName()+" 结束执行");
                    } catch (Exception e) {
                        e.printStackTrace();
                    }finally {
                        countDownLatch.countDown();  //这个不管是否异常都需要数量减,否则会被堵塞无法结束
                    }
            });
        }
        threadPool.shutdown();
        try {
            countDownLatch.await();
        }catch (Exception e) {
            e.printStackTrace();
        }

        log.info(">>>>>>>gema over<<<<<<<");

    }

    @Test
    public void test2() {

        ArrayList<String> list = new ArrayList<>();
        list.add("Tom");
        list.add("Bob");
        list.add("Jane");
        list.add("Jane");
        list.add("Jane");
        HashSet<String> set = new HashSet<>();
        set.add("Tom");
        set.add("Bob");
        set.add("Jane");
        set.add("Jane");
        set.add("Jane");

        list.forEach(l -> System.out.println(">>>>>list:" + l));
//      set.forEach(l -> System.out.println(">>>>>set:" + l));
        HashSet<String> outSet = new HashSet<>(list);
//        outSet.forEach(l -> System.out.println(">>>>>Outset:" + l));

        List<String> outList = new ArrayList<>(outSet);
//        outList.forEach(l -> System.out.println(">>>>>outList:" + l));

        AtomicReference<String> str = new AtomicReference<>("");
        outList.forEach(l -> {
            str.set(str + "\"" + l + "\"" + ",");
        });
        System.out.println(str);

        String s = str.toString();
        String su = s.substring(0,s.length()-1);
        System.out.println(su);
    }

    @Test
    public void test3() {
        List<User> list = userMapper.selectList(new QueryWrapper<>());
        list.forEach(l -> System.out.println(l));
    }

    @Test
    public void test4(){
        String str = "{\"aggregations\":{\"group_by_time\":{\"buckets\":[{\"key_as_string\":\"2021-04-06 10:20:00\",\"key\":1617675600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"XXH_pHgBnk-RZhUUeec_\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15569530880},\"free\":1086877696}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617675894130]}]}}},{\"key_as_string\":\"2021-04-06 10:25:00\",\"key\":1617675900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"v3EEpXgBnk-RZhUUDfkd\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15567958016},\"free\":1088450560}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617676194130]}]}}},{\"key_as_string\":\"2021-04-06 10:30:00\",\"key\":1617676200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"InIIpXgBnk-RZhUUoAz8\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567544320},\"free\":1088864256}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617676494130]}]}}},{\"key_as_string\":\"2021-04-06 10:35:00\",\"key\":1617676500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"hnINpXgBnk-RZhUUNB7b\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573254144},\"free\":1083154432}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617676794130]}]}}},{\"key_as_string\":\"2021-04-06 10:40:00\",\"key\":1617676800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"2nIRpXgBnk-RZhUUyDC5\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15574245376},\"free\":1082163200}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617677094130]}]}}},{\"key_as_string\":\"2021-04-06 10:45:00\",\"key\":1617677100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"MXIWpXgBnk-RZhUUXEOY\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15574138880},\"free\":1082269696}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617677394130]}]}}},{\"key_as_string\":\"2021-04-06 10:50:00\",\"key\":1617677400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"gXIapXgBnk-RZhUU8FV3\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9354,\"bytes\":15580426240},\"free\":1075982336}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617677694130]}]}}},{\"key_as_string\":\"2021-04-06 10:55:00\",\"key\":1617677700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"3nIfpXgBnk-RZhUUhGdW\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T02:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9351,\"bytes\":15576043520},\"free\":1080365056}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617677994130]}]}}},{\"key_as_string\":\"2021-04-06 11:00:00\",\"key\":1617678000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"KnIkpXgBnk-RZhUUGHo0\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573856256},\"free\":1082552320}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617678294130]}]}}},{\"key_as_string\":\"2021-04-06 11:05:00\",\"key\":1617678300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"f3IopXgBnk-RZhUUrIwT\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15570939904},\"free\":1085468672}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617678594130]}]}}},{\"key_as_string\":\"2021-04-06 11:10:00\",\"key\":1617678600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"23ItpXgBnk-RZhUUP57y\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15574114304},\"free\":1082294272}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617678894130]}]}}},{\"key_as_string\":\"2021-04-06 11:15:00\",\"key\":1617678900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"MHIxpXgBnk-RZhUU07HR\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15568936960},\"free\":1087471616}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617679194130]}]}}},{\"key_as_string\":\"2021-04-06 11:20:00\",\"key\":1617679200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"jnI2pXgBnk-RZhUUZ8Ow\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15567994880},\"free\":1088413696}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617679494130]}]}}},{\"key_as_string\":\"2021-04-06 11:25:00\",\"key\":1617679500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"6XI6pXgBnk-RZhUU-9WO\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573577728},\"free\":1082830848}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617679794130]}]}}},{\"key_as_string\":\"2021-04-06 11:30:00\",\"key\":1617679800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"R3I_pXgBnk-RZhUUj-hu\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9351,\"bytes\":15574667264},\"free\":1081741312}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617680094130]}]}}},{\"key_as_string\":\"2021-04-06 11:35:00\",\"key\":1617680100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"n3JEpXgBnk-RZhUUI_pM\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15569993728},\"free\":1086414848}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617680394130]}]}}},{\"key_as_string\":\"2021-04-06 11:40:00\",\"key\":1617680400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"83NIpXgBnk-RZhUUtwwr\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567171584},\"free\":1089236992}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617680694130]}]}}},{\"key_as_string\":\"2021-04-06 11:45:00\",\"key\":1617680700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"THNNpXgBnk-RZhUUSx8J\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15572942848},\"free\":1083465728}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617680994130]}]}}},{\"key_as_string\":\"2021-04-06 11:50:00\",\"key\":1617681000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"pXNRpXgBnk-RZhUU3jHo\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15574519808},\"free\":1081888768}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617681294130]}]}}},{\"key_as_string\":\"2021-04-06 11:55:00\",\"key\":1617681300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"-nNWpXgBnk-RZhUUckPH\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T03:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15571849216},\"free\":1084559360}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617681594130]}]}}},{\"key_as_string\":\"2021-04-06 12:00:00\",\"key\":1617681600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"UHNbpXgBnk-RZhUUBlam\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15569739776},\"free\":1086668800}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617681894130]}]}}},{\"key_as_string\":\"2021-04-06 12:05:00\",\"key\":1617681900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"qHNfpXgBnk-RZhUUmmiE\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9352,\"bytes\":15577362432},\"free\":1079046144}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617682194130]}]}}},{\"key_as_string\":\"2021-04-06 12:10:00\",\"key\":1617682200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"CHNkpXgBnk-RZhUULntk\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573372928},\"free\":1083035648}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617682494130]}]}}},{\"key_as_string\":\"2021-04-06 12:15:00\",\"key\":1617682500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"ZHNopXgBnk-RZhUUwo1E\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567147008},\"free\":1089261568}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617682794130]}]}}},{\"key_as_string\":\"2021-04-06 12:20:00\",\"key\":1617682800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"vHNtpXgBnk-RZhUUVp8h\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9352,\"bytes\":15576387584},\"free\":1080020992}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617683094130]}]}}},{\"key_as_string\":\"2021-04-06 12:25:00\",\"key\":1617683100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"IHNxpXgBnk-RZhUU6bL_\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9351,\"bytes\":15575441408},\"free\":1080967168}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617683394130]}]}}},{\"key_as_string\":\"2021-04-06 12:30:00\",\"key\":1617683400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"eXN2pXgBnk-RZhUUfcTe\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573667840},\"free\":1082740736}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617683694130]}]}}},{\"key_as_string\":\"2021-04-06 12:35:00\",\"key\":1617683700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"1XN7pXgBnk-RZhUUEda9\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567785984},\"free\":1088622592}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617683994130]}]}}},{\"key_as_string\":\"2021-04-06 12:40:00\",\"key\":1617684000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"K3N_pXgBnk-RZhUUpemb\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15571963904},\"free\":1084444672}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617684294130]}]}}},{\"key_as_string\":\"2021-04-06 12:45:00\",\"key\":1617684300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"hXOEpXgBnk-RZhUUOft6\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15572541440},\"free\":1083867136}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617684594130]}]}}},{\"key_as_string\":\"2021-04-06 12:50:00\",\"key\":1617684600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"2HSIpXgBnk-RZhUUzQ1Z\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567114240},\"free\":1089294336}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617684894130]}]}}},{\"key_as_string\":\"2021-04-06 12:55:00\",\"key\":1617684900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"MHSNpXgBnk-RZhUUYSA3\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T04:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567527936},\"free\":1088880640}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617685194130]}]}}},{\"key_as_string\":\"2021-04-06 13:00:00\",\"key\":1617685200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"hHSRpXgBnk-RZhUU9TIW\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15570944000},\"free\":1085464576}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617685494130]}]}}},{\"key_as_string\":\"2021-04-06 13:05:00\",\"key\":1617685500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"1HSWpXgBnk-RZhUUiET1\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567908864},\"free\":1088499712}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617685794130]}]}}},{\"key_as_string\":\"2021-04-06 13:10:00\",\"key\":1617685800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"JHSbpXgBnk-RZhUUHFfU\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567056896},\"free\":1089351680}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617686094130]}]}}},{\"key_as_string\":\"2021-04-06 13:15:00\",\"key\":1617686100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"a3SfpXgBnk-RZhUUsGmy\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573987328},\"free\":1082421248}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617686394130]}]}}},{\"key_as_string\":\"2021-04-06 13:20:00\",\"key\":1617686400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"unSkpXgBnk-RZhUURHuR\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15571623936},\"free\":1084784640}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617686694130]}]}}},{\"key_as_string\":\"2021-04-06 13:25:00\",\"key\":1617686700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"E3SopXgBnk-RZhUU2I5w\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15571243008},\"free\":1085165568}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617686994130]}]}}},{\"key_as_string\":\"2021-04-06 13:30:00\",\"key\":1617687000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"dXStpXgBnk-RZhUUbKBP\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15570939904},\"free\":1085468672}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617687294130]}]}}},{\"key_as_string\":\"2021-04-06 13:35:00\",\"key\":1617687300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"2nSypXgBnk-RZhUUALIt\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9354,\"bytes\":15580516352},\"free\":1075892224}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617687594130]}]}}},{\"key_as_string\":\"2021-04-06 13:40:00\",\"key\":1617687600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"NXS2pXgBnk-RZhUUlMUM\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15572008960},\"free\":1084399616}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617687894130]}]}}},{\"key_as_string\":\"2021-04-06 13:45:00\",\"key\":1617687900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"mXS7pXgBnk-RZhUUJ9fr\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15568949248},\"free\":1087459328}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617688194130]}]}}},{\"key_as_string\":\"2021-04-06 13:50:00\",\"key\":1617688200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"_XS_pXgBnk-RZhUUu-nK\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15568633856},\"free\":1087774720}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617688494130]}]}}},{\"key_as_string\":\"2021-04-06 13:55:00\",\"key\":1617688500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"VnTEpXgBnk-RZhUUT_yp\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T05:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15571226624},\"free\":1085181952}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617688794130]}]}}},{\"key_as_string\":\"2021-04-06 14:00:00\",\"key\":1617688800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"oHXIpXgBnk-RZhUU4w6I\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15569678336},\"free\":1086730240}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617689094130]}]}}},{\"key_as_string\":\"2021-04-06 14:05:00\",\"key\":1617689100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"7XXNpXgBnk-RZhUUdyBm\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15566651392},\"free\":1089757184}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617689394130]}]}}},{\"key_as_string\":\"2021-04-06 14:10:00\",\"key\":1617689400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"Q3XSpXgBnk-RZhUUCzNF\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9351,\"bytes\":15575531520},\"free\":1080877056}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617689694130]}]}}},{\"key_as_string\":\"2021-04-06 14:15:00\",\"key\":1617689700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"nXXWpXgBnk-RZhUUn0Uk\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15571918848},\"free\":1084489728}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617689994130]}]}}},{\"key_as_string\":\"2021-04-06 14:20:00\",\"key\":1617690000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"93XbpXgBnk-RZhUUM1cD\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15572271104},\"free\":1084137472}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617690294130]}]}}},{\"key_as_string\":\"2021-04-06 14:25:00\",\"key\":1617690300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"QXXfpXgBnk-RZhUUxmrh\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15569645568},\"free\":1086763008}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617690594130]}]}}},{\"key_as_string\":\"2021-04-06 14:30:00\",\"key\":1617690600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"m3XkpXgBnk-RZhUUWnzA\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9352,\"bytes\":15577034752},\"free\":1079373824}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617690894130]}]}}},{\"key_as_string\":\"2021-04-06 14:35:00\",\"key\":1617690900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"9HXopXgBnk-RZhUU7o6f\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9351,\"bytes\":15575519232},\"free\":1080889344}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617691194130]}]}}},{\"key_as_string\":\"2021-04-06 14:40:00\",\"key\":1617691200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"SnXtpXgBnk-RZhUUgqF9\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567548416},\"free\":1088860160}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617691494130]}]}}},{\"key_as_string\":\"2021-04-06 14:45:00\",\"key\":1617691500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"pnXypXgBnk-RZhUUFrNc\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9345,\"bytes\":15565099008},\"free\":1091309568}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617691794130]}]}}},{\"key_as_string\":\"2021-04-06 14:50:00\",\"key\":1617691800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"9XX2pXgBnk-RZhUUqsU7\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15570976768},\"free\":1085431808}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617692094130]}]}}},{\"key_as_string\":\"2021-04-06 14:55:00\",\"key\":1617692100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"SXX7pXgBnk-RZhUUPtga\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T06:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15573204992},\"free\":1083203584}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617692394130]}]}}},{\"key_as_string\":\"2021-04-06 15:00:00\",\"key\":1617692400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"nnX_pXgBnk-RZhUU0er5\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15569584128},\"free\":1086824448}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617692694130]}]}}},{\"key_as_string\":\"2021-04-06 15:05:00\",\"key\":1617692700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"8nUEpngBnk-RZhUUZfzX\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9351,\"bytes\":15575035904},\"free\":1081372672}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617692994130]}]}}},{\"key_as_string\":\"2021-04-06 15:10:00\",\"key\":1617693000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"RXYIpngBnk-RZhUU-Q-2\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15569530880},\"free\":1086877696}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617693294130]}]}}},{\"key_as_string\":\"2021-04-06 15:15:00\",\"key\":1617693300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"onYNpngBnk-RZhUUjSGV\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15566290944},\"free\":1090117632}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617693594130]}]}}},{\"key_as_string\":\"2021-04-06 15:20:00\",\"key\":1617693600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"-nYSpngBnk-RZhUUITN0\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15566594048},\"free\":1089814528}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617693894130]}]}}},{\"key_as_string\":\"2021-04-06 15:25:00\",\"key\":1617693900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"UHYWpngBnk-RZhUUtUZS\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15572758528},\"free\":1083650048}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617694194130]}]}}},{\"key_as_string\":\"2021-04-06 15:30:00\",\"key\":1617694200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"pHYbpngBnk-RZhUUSVgx\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15572086784},\"free\":1084321792}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617694494130]}]}}},{\"key_as_string\":\"2021-04-06 15:35:00\",\"key\":1617694500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"63YfpngBnk-RZhUU3WoQ\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15568093184},\"free\":1088315392}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617694794130]}]}}},{\"key_as_string\":\"2021-04-06 15:40:00\",\"key\":1617694800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"T3YkpngBnk-RZhUUcH3v\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9345,\"bytes\":15564591104},\"free\":1091817472}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617695094130]}]}}},{\"key_as_string\":\"2021-04-06 15:45:00\",\"key\":1617695100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"rnYppngBnk-RZhUUBI_N\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15572267008},\"free\":1084141568}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617695394130]}]}}},{\"key_as_string\":\"2021-04-06 15:50:00\",\"key\":1617695400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"_nYtpngBnk-RZhUUmKGs\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15574327296},\"free\":1082081280}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617695694130]}]}}},{\"key_as_string\":\"2021-04-06 15:55:00\",\"key\":1617695700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"S3YypngBnk-RZhUULLSL\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T07:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15571288064},\"free\":1085120512}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617695994130]}]}}},{\"key_as_string\":\"2021-04-06 16:00:00\",\"key\":1617696000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"oXY2pngBnk-RZhUUwMZq\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9353,\"bytes\":15579201536},\"free\":1077207040}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617696294130]}]}}},{\"key_as_string\":\"2021-04-06 16:05:00\",\"key\":1617696300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"_XY7pngBnk-RZhUUVNhI\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9352,\"bytes\":15576649728},\"free\":1079758848}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617696594130]}]}}},{\"key_as_string\":\"2021-04-06 16:10:00\",\"key\":1617696600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"WHY_pngBnk-RZhUU6Osn\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15571099648},\"free\":1085308928}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617696894130]}]}}},{\"key_as_string\":\"2021-04-06 16:15:00\",\"key\":1617696900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"p3ZEpngBnk-RZhUUfP0G\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15568060416},\"free\":1088348160}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617697194130]}]}}},{\"key_as_string\":\"2021-04-06 16:20:00\",\"key\":1617697200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"7XdJpngBnk-RZhUUDw_l\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:24:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.935,\"bytes\":15574540288},\"free\":1081868288}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617697494130]}]}}},{\"key_as_string\":\"2021-04-06 16:25:00\",\"key\":1617697500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"QndNpngBnk-RZhUUoyLE\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:29:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15570534400},\"free\":1085874176}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617697794130]}]}}},{\"key_as_string\":\"2021-04-06 16:30:00\",\"key\":1617697800000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"mXdSpngBnk-RZhUUNzSi\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:34:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9345,\"bytes\":15565316096},\"free\":1091092480}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617698094130]}]}}},{\"key_as_string\":\"2021-04-06 16:35:00\",\"key\":1617698100000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"_ndWpngBnk-RZhUUy0aB\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:39:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15569379328},\"free\":1087029248}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617698394130]}]}}},{\"key_as_string\":\"2021-04-06 16:40:00\",\"key\":1617698400000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"13depngBnk-RZhUU4VfY\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:44:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9355,\"bytes\":15581888512},\"free\":1074520064}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617698694130]}]}}},{\"key_as_string\":\"2021-04-06 16:45:00\",\"key\":1617698700000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"xXdfpngBnk-RZhUU82s-\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:49:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9359,\"bytes\":15589097472},\"free\":1067311104}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617698994130]}]}}},{\"key_as_string\":\"2021-04-06 16:50:00\",\"key\":1617699000000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"F3dkpngBnk-RZhUUh34d\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:54:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9358,\"bytes\":15587033088},\"free\":1069375488}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617699294130]}]}}},{\"key_as_string\":\"2021-04-06 16:55:00\",\"key\":1617699300000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"9ndppngBnk-RZhUUGpD7\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T08:59:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9354,\"bytes\":15580708864},\"free\":1075699712}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617699594130]}]}}},{\"key_as_string\":\"2021-04-06 17:00:00\",\"key\":1617699600000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"nHdtpngBnk-RZhUUrqPa\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T09:04:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9353,\"bytes\":15577972736},\"free\":1078435840}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617699894130]}]}}},{\"key_as_string\":\"2021-04-06 17:05:00\",\"key\":1617699900000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"SXdypngBnk-RZhUUQra5\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T09:09:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9348,\"bytes\":15571243008},\"free\":1085165568}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617700194130]}]}}},{\"key_as_string\":\"2021-04-06 17:10:00\",\"key\":1617700200000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"5nd2pngBnk-RZhUU1siX\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T09:14:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9346,\"bytes\":15567044608},\"free\":1089363968}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617700494130]}]}}},{\"key_as_string\":\"2021-04-06 17:15:00\",\"key\":1617700500000,\"doc_count\":30,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":30,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"fnd7pngBnk-RZhUUatt2\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T09:19:54.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9349,\"bytes\":15571927040},\"free\":1084481536}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617700794130]}]}}},{\"key_as_string\":\"2021-04-06 17:20:00\",\"key\":1617700800000,\"doc_count\":29,\"top_score_hits\":{\"hits\":{\"total\":{\"value\":29,\"relation\":\"eq\"},\"max_score\":null,\"hits\":[{\"_index\":\"metricbeat-7.4.2-2021.04.06\",\"_type\":\"_doc\",\"_id\":\"cnd_pngBnk-RZhUU1-1R\",\"_score\":null,\"_source\":{\"@timestamp\":\"2021-04-06T09:24:44.130Z\",\"system\":{\"memory\":{\"actual\":{\"used\":{\"pct\":0.9347,\"bytes\":15568773120},\"free\":1087635456}}},\"host\":{\"hostname\":\"es-0001\"}},\"sort\":[1617701084130]}]}}}]}}}";

        List<EsData> esData = jsonMemoryPar(str);


    }
    public List<EsData> jsonMemoryPar(String str) {
        List<EsData> list = new ArrayList<>();
        if (!StringUtils.isEmpty(str)) {
            JSONObject json = JSONObject.parseObject(str);
            JSONArray jsonArray = json.getJSONObject("aggregations").getJSONObject("group_by_time").getJSONArray("buckets");
            for (int i = 0; i <jsonArray.size() ; i++) {
//                log.info("内存外层：>>>>>"+jsonArray.getString(i));
                JSONObject jsonObject = jsonArray.getJSONObject(i);
                String h3 = jsonObject.getJSONObject("top_score_hits").getJSONObject("hits").getString("hits");
                if (!StringUtils.isEmpty(h3)) {
                    List<EsBase> baseList = JSON.parseArray(h3, EsBase.class);
//                    baseList.forEach(b -> log.info("内存内层>>>"+b));
                    if (!CollectionUtils.isEmpty(baseList)) {
                        baseList.forEach(b -> {
                            if (b != null) {
                                Double pct = b.getSource().getSystem().getMemory().getActual().getUsed().getPct();
                                LocalDateTime time = b.getSource().getTimestamp();
                                System.out.println("正常："+time+"  相减："+time.minusHours(8));
                                list.add(new EsData(pct,time));
                            }
                        });
                    }
                }
            }
        }
        return list;
    }

}



